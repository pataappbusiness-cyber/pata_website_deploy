"use strict";class CustomSelect{constructor(e,t={}){this.select=e,this.options={placeholder:e.dataset.placeholder||"Selecione uma opção",searchable:"true"===e.dataset.searchable,...t},this.selectedIndex=this.select.selectedIndex,this.isOpen=!1,this.wrapper=null,this.dropdown=null,this.searchInput=null,this.init(),this.attachEvents()}init(){this.wrapper=document.createElement("div"),this.wrapper.className="custom-select",this.wrapper.dataset.selectId=this.select.id;const e=document.createElement("button");e.type="button",e.className="custom-select-trigger",e.setAttribute("aria-haspopup","listbox"),e.setAttribute("aria-expanded","false");const t=document.createElement("span");t.className="custom-select-text",t.textContent=this.getSelectedText();const s=document.createElement("span");if(s.className="custom-select-arrow",s.setAttribute("aria-hidden","true"),s.innerHTML='<svg width="12" height="8" viewBox="0 0 12 8"><path d="M1 1l5 5 5-5" stroke="currentColor" fill="none" stroke-width="2"/></svg>',e.appendChild(t),e.appendChild(s),this.dropdown=document.createElement("div"),this.dropdown.className="custom-select-dropdown",this.dropdown.setAttribute("role","listbox"),this.options.searchable){const e=document.createElement("div");e.className="custom-select-search",this.searchInput=document.createElement("input"),this.searchInput.type="text",this.searchInput.className="custom-select-search-input",this.searchInput.placeholder="Procurar...",this.searchInput.setAttribute("aria-label","Procurar opções"),e.appendChild(this.searchInput),this.dropdown.appendChild(e)}const i=document.createElement("ul");i.className="custom-select-options",Array.from(this.select.options).forEach((e,t)=>{if(0===t&&""===e.value)return;const s=document.createElement("li");s.className="custom-select-option",s.setAttribute("role","option"),s.setAttribute("data-value",e.value),s.setAttribute("data-index",t),s.setAttribute("tabindex","0"),s.textContent=e.text,t===this.selectedIndex?(s.classList.add("selected"),s.setAttribute("aria-selected","true")):s.setAttribute("aria-selected","false"),i.appendChild(s)}),this.dropdown.appendChild(i),this.wrapper.appendChild(e),this.wrapper.appendChild(this.dropdown),this.select.style.display="none",this.select.setAttribute("tabindex","-1"),this.select.parentNode.insertBefore(this.wrapper,this.select)}attachEvents(){const e=this.wrapper.querySelector(".custom-select-trigger"),t=this.dropdown.querySelectorAll(".custom-select-option");e.addEventListener("click",e=>{e.preventDefault(),this.toggle()}),t.forEach(e=>{e.addEventListener("click",()=>{this.selectOption(parseInt(e.dataset.index))}),e.addEventListener("keydown",t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),this.selectOption(parseInt(e.dataset.index)))})}),this.searchInput&&(this.searchInput.addEventListener("input",e=>{this.filterOptions(e.target.value)}),this.searchInput.addEventListener("keydown",e=>{if("ArrowDown"===e.key){e.preventDefault();const t=this.dropdown.querySelector('.custom-select-option:not([style*="display: none"])');t&&t.focus()}})),document.addEventListener("click",e=>{this.wrapper.contains(e.target)||this.close()}),e.addEventListener("keydown",e=>{switch(e.key){case"Enter":case" ":e.preventDefault(),this.toggle();break;case"Escape":this.close();break;case"ArrowDown":e.preventDefault(),this.isOpen?this.focusNextOption():this.open();break;case"ArrowUp":e.preventDefault(),this.isOpen?this.focusPrevOption():this.open()}}),t.forEach((t,s)=>{t.addEventListener("keydown",t=>{switch(t.key){case"ArrowDown":t.preventDefault(),this.focusNextOption(s);break;case"ArrowUp":t.preventDefault(),this.focusPrevOption(s);break;case"Escape":t.preventDefault(),this.close(),e.focus();break;case"Tab":this.close()}})})}getSelectedText(){return 0===this.selectedIndex||-1===this.selectedIndex?this.options.placeholder:this.select.options[this.selectedIndex].text}selectOption(e){this.selectedIndex=e,this.select.selectedIndex=e;this.wrapper.querySelector(".custom-select-text").textContent=this.select.options[e].text;this.dropdown.querySelectorAll(".custom-select-option").forEach(e=>{e.classList.remove("selected"),e.setAttribute("aria-selected","false")});const t=this.dropdown.querySelector(`[data-index="${e}"]`);if(t&&(t.classList.add("selected"),t.setAttribute("aria-selected","true")),this.select.dispatchEvent(new Event("change",{bubbles:!0})),this.select.classList.contains("error")){this.select.classList.remove("error");const e=document.getElementById(`${this.select.id}Error`);e&&e.classList.remove("show")}this.close()}filterOptions(e){const t=this.dropdown.querySelectorAll(".custom-select-option"),s=e.toLowerCase();let i=!1;t.forEach(e=>{const t=e.textContent.toLowerCase().includes(s);e.style.display=t?"":"none",t&&(i=!0)});let o=this.dropdown.querySelector(".custom-select-no-results");!i&&s?(o||(o=document.createElement("div"),o.className="custom-select-no-results",o.textContent="Nenhum resultado encontrado",this.dropdown.querySelector(".custom-select-options").appendChild(o)),o.style.display="block"):o&&(o.style.display="none")}open(){this.isOpen=!0,this.wrapper.classList.add("open"),this.wrapper.querySelector(".custom-select-trigger").setAttribute("aria-expanded","true"),this.searchInput&&setTimeout(()=>this.searchInput.focus(),50)}close(){this.isOpen=!1,this.wrapper.classList.remove("open"),this.wrapper.querySelector(".custom-select-trigger").setAttribute("aria-expanded","false"),this.searchInput&&(this.searchInput.value="",this.filterOptions(""))}toggle(){this.isOpen?this.close():this.open()}focusNextOption(e=-1){const t=Array.from(this.dropdown.querySelectorAll('.custom-select-option:not([style*="display: none"])'));if(0!==t.length)if(-1===e)t[0]?.focus();else{const s=t.findIndex(t=>parseInt(t.dataset.index)===e),i=Math.min(s+1,t.length-1);t[i]?.focus()}}focusPrevOption(e=-1){const t=Array.from(this.dropdown.querySelectorAll('.custom-select-option:not([style*="display: none"])'));if(0!==t.length)if(-1===e)t[t.length-1]?.focus();else{const s=t.findIndex(t=>parseInt(t.dataset.index)===e),i=Math.max(s-1,0);t[i]?.focus()}}destroy(){this.wrapper.remove(),this.select.style.display="",this.select.setAttribute("tabindex","0")}}function initCustomSelects(){const e=document.querySelectorAll(".waitlist-form-select");e.forEach(e=>{if("true"===e.dataset.customSelectInitialized)return;const t="waitlistDistrito"===e.id;new CustomSelect(e,{searchable:t}),e.dataset.customSelectInitialized="true"}),devLog("Custom selects initialized:",e.length)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initCustomSelects):initCustomSelects(),"undefined"!=typeof window&&(window.CustomSelect=CustomSelect,window.initCustomSelects=initCustomSelects);